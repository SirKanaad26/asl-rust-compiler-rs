# ASL-to-Rust Compiler (Rust Rewrite)

## Status: Definitions — Builtin Types, Constants, Abstract Types Added

### Done
- [x] Builtin type handling: `__builtin type integer;` → `// builtin: integer` (comment-only, since `map_type()` already handles the actual mapping)
- [x] Constants: `constant integer MAX = 100;` → `pub const MAX: i64 = 100;`
- [x] Abstract types: `type MyOpaqueType;` → `pub struct MyOpaqueType;`
- [x] Project setup with Cargo
- [x] ANTLR4 grammar adapted for Rust target (renamed `type` → `typeSpec`, `base` → `sliceBase`)
- [x] Parser generation using antlr4rust (antlr4-4.8-2-SNAPSHOT)
- [x] Basic register parsing: `__register 32 {} NAME;` → `pub struct NAME(u32);`
- [x] Register bitfields with getter/setter generation
- [x] Array registers: `array [0..N] of __register...`
- [x] Optimized codegen (skip redundant shifts/masks)
- [x] Modular codegen structure (`codegen/emitter.rs`, `codegen/registers.rs`)
- [x] CLI: mode-based input/output file arguments
- [x] Type aliases: `type MyInt = integer;` → `pub type MyInt = i64;`
- [x] Enumerations: `enumeration Color { RED, GREEN, BLUE };` → `pub enum Color { ... }`
- [x] Structs: `type Point is (integer x, integer y)` → `pub struct Point { ... }`

### Notes
- Builtin types are skipped (comment only) because `map_type()` in `codegen/types.rs` already maps `integer` → `i64`, `boolean` → `bool`, etc.
- Constant expressions use raw `get_text()` for now — ASL `TRUE` passes through as `TRUE` instead of Rust `true`. Will be fixed when expression translation is built.
- ASL files must end with a trailing newline — the grammar defines `SEMICOLON : ';' ENDLINE` where `ENDLINE` requires `\n`.

### Not Yet Implemented
- [ ] Variables: `integer myVar;`
- [ ] Array definitions: `array integer arr[0..10];`
- [ ] Functions/procedures
- [ ] Getters/setters
- [ ] Statements (if, for, while, etc.)
- [ ] Expressions

### Dependencies
- antlr-rust = "0.3"
- Grammar: `grammar/asl.g4`

### Usage
```bash
cargo run -- definitions examples/builtin_type.asl output/builtin_type.rs
cargo run -- definitions examples/constant.asl output/constants.rs
cargo run -- definitions examples/abstract_type.asl output/abstract_type.rs
```